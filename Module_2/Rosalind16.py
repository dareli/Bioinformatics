#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Rosalind 16, Find Patterns Forming Clumps in a String

def find_clumps(genome, k, L, t):
    clumps = set()  
    n = len(genome)  # for length of the genome

    for i in range(n - L + 1): # loop through all windows 
        window = genome[i:i+L]  # current window 
        kmer_counts = {}  # dictionary to count frequencies for the window

        for j in range(L - k + 1): # count frequencies of all k-mer in the window
            kmer = window[j:j+k] 
            
            if kmer in kmer_counts: # increment the count 
                kmer_counts[kmer] += 1
            else:
                kmer_counts[kmer] = 1

        for kmer, count in kmer_counts.items(): # add k-mers that pops up at least t times to clumps
            if count >= t:
                clumps.add(kmer)

    return clumps


genome = "AAAATTCCTTAATTAGCGCCTTTGTAAGCATAGCGGATAGCGGATTCAATTTTGGCCAGTGGTTAAGATTAGCGTGCGAAATGAAAGTAATTGGACCGTTCGGAAGAATCATCACTAAAGACCGTTCCTCTTGGCGCGGTTAAGTCCGGTGCTCTGTGCGAGCGGTTGGGGCCTAGCTGGTGTTAAGGAGCGTACAATTGTACCCACATCAGGTTTAGCGGGGTTGAGATTTTTGCCAGTGCTTTGTTTGCTCGTAGGACGGGAGTAGAGTCTCTTTCCTCCCCGGAGCAATGGGTAGCAACCCTAGCAATGGGGAGGAGGCTAAACATCCAAGCAATGGGGAGCAATGGGTCGGCTGCAAGCAATGGGAATGGAGCAAAGCAATGGGGGATGCGGACCTATTAGCAATGGGACATAAAAGCAATGGGTACAGCAATGAGCAATGGGGGGCTTAATCAGTAGCAATGGGCATGCATTCTCGACCCTAACTAATCGGTCCGAAGCAATAGCAATGGGGCGGTGGTATTGGCGGGACCCATACTATGCGCAGCAATGGGCCGCAGCAATGGGGATCGTACCGGCAAGTGTATGGGCATAGGCTACCCTGCGCGCCACCAACGTAGAAGCTCCGCAAGATGAGTAGCAATGGGGCATACGCTAGACTAGCAATGGGGAGCAATGGGTGGGACGTTTAGCAATGGGCAGATTTAGCAATGGGGAGCCTAATGCTTGGAGGGATCGCGTTGCTAAAGAGAAGCAATGGGAGCAATGGGACGTTTAGTCTAGCAGCAATGGGTTAGGTACGAAGCAAAGCAATGGGACGAGCAATGGGATGGGCGCTAACGGGTCATGTCTTGTGCGCCGGTAACTTACAGAAACTCCGAAAAAGTATCACGACCGACTGAAATTATTAGAAGTGTGAGATGATGGCCACGGTACTGGTCAGTGATGACGGCCTAGGCCGACCAATCTGGTACAGCTACGTAACTGGGGGACGACTTCTGAGATCTGTTCTGAGGGGACCACCTGTAAGCGAAAATACCAGTTGTACTCGCAAGGTGTCTGCAAAAGGAGGGGAGTCCAACACCCGTTAATCCTAATTCGCATCCGTCTGTTAAATGCAGCGCCCCCGTTTTCTCATTTCGGCCGCAAGTAGTTCTAAACCTTGCGTCTCTTTATAATGCGCCGTAGGAAACATCACAGAGGGTTGGAATAGAAGATAATTTAACAAAGCGGAGGCACCTTGCCCCTATGTTGTAATCGCGTCGGTTACAAAATGGGTATTCCAGCTTAGGGTTGGTGTCTGAATGAACGGTGTGTGGCGGTTCCAGCTTACTGCGCATGTGATGTCCGTTTAGGGAGAAGTTCCAGCTTGCAGAATTTGGGTGCACCAGTTAGTGACCAAAATTGAAGACACGCAAGACACGCACATTTTCCAGCTTACACGCAGCAGACACAGACACGCACTAGACTTCTTCCAGTTCCAGTTCCAGCTTGCAAAACAGTAGGTCCATAGCTTCCAGCTTAAGTCTTGGACAACCAAAAATCTTATCTTTCCAGCTTTCTTCCAGCTTTCCTTCCAGCTTGGAAAGACACGCTTCCAGCTTAGCTTTTCCAGCTTTAGACACGTTCCAGCTTCGCAACATCTTCATGTTTCCAGCTTCTTTCCAGCTTGACACGCAGGTACGGGCCCGGAGATTCCAGCTTTTCCAGCTTTCCAGCTTTAGTTCCAGCTTGACTAGAAAGTGTTCCAGCTTTTTCCAGCTTGCGATAAGCAAAGACTTTCCAGCTTTAGATAATGTGCACCTGCATCCTTACTAACTTCTGTTCCTATTATAGACACGCAGCACCTCTGTTCACTAGACTTCCAGCTTGCAGACACGCACACAGACACAGACACGCATTCGCGGTTAAAAAAGACACGCACGCACACGCACAGCCGTCTAGGGCGCACGACTGGTTCGAGACACGCATGTGTATTTTTGTTTAACCGGTCCGATTCTGGGCCCCTACCGCCACGCTGTGTTTCAAGCTGTAGTCCATGCCTAGTGTCTTGGGACGCGCCACGGGTAACAGCGGTGTTACAAAATCAAGAGAAAACCTTGGAGAAGTTGGTCAACCGTATCTGAGCTGAACCATTGACGGCGAGAGTATCCCACTCAAACGGATCTGGGAATACAGGGCGTTTGTATAGGGTGGGTCCGTGTTGGGAATGGAGTTACCACGCACCGCTTGCCAAATTATCTCGCGCCACGTTGAGTTTTTCTTTAACGCATTTTGCACAAGGGTACACGACAGCCCGTGGTACAATCTAACGCATCAACCCGTTCAATAACATCGACTCCTAAATTGGTAGGTTCTTGTAGCTATCGCGAAACCTGGAAATGGAGCTTGTGGATTACCGGACTATGTGAGTAATTCGAGTGTGTATGCTTATGGAAGCGCTCACTAGTTCCGGTCGATATCGCGGTCGATAGGTTCGGTCGATAAGAAACCTCCGCGTGGAATCGGTCGATAGCCATGATCCGTAAGGATATATACCGGTCGATAGAACCGCTTGGCCTGCTGCAGGTAGCTAGAAGCGGTCGATACAGAACGGTCGATAATCGGTCGATAGTCGATATTCACACGTTCCAATGGGGTACGGTCGATAATCGGTCGATATATCGGTCGATAACTCCTAATGATTTCCATCTCCACAGAAGACCACGGTCGATATGCTCGTCGGTCGATAGGTCGATACGGTCGATATAGCAACGGCGGTCGATAGTCCTCGGTCGATATACCTAATCGGTCGATATCTCATGGTCTACAGCAAGCGACCTACTGCACGCCTTTAACAGCTGAGTTTTAAACGGTCGATAGCGGTCGATATCCTATACGGTCGATAATCGCAAATAATAATATCACGGGGAAAGGGCCGGTCGATAAAAAAAATCACTTATCGGAGGTCAAACCCAGCTGCGGTCGATATATTCCGGTCGATACGGTCGATAGCACAGGCAAGCTTCTCCACGTGTTCACGGTCGCGGTCGATATAGCACGTTACATTCTCCACGTCCACGGTTCTCCACGTTTCTCCACGAGAGGCTGACCTTGCATTCTCCACGTACGCGCCCGTGAACGTTTTCTCCACGTTCTCCACGATGTACTCATTTCTCCACGGCGAGATTGCCCCGCCTGTTGGCACGTGGAATTCTCCACGCAAATACTAATTTAGCGCCCACCTAGGGCTGTTCTCCACGGGTGACGCTACTTTTCTCCACGGCTGGAATGTGCGCCCTAAAACAGTGTTTCTCCACGTTCTCCACGGCTAGCCCGAATGAGCCTTCTCCACGGGCAGGTGTTCTCCACGACAGCTTCTCCACTTCTCCACGGAAAGGAGCAATTCTCCACGGCTTCACAGTTCTCCATTCTCCACGTCTTCTCCACGAGGCGAAAGCTTTTCTTCTCCACGCACGGCAAAGGCTTCTCCACGCGTTCTCCACGAAAGCAGCAAAGGGATAACGCTATAATTCAGCACAGTTCTCCACGCAAAGGTTCTCCACGCAACAGCAAAGGTCATCGCAGCGCTATGGGCCTCAAGGCATTCTTCTGGAACCAGCAAAGGAGGAGGGCAGCCGTTATCAAACGAGATCCACAGCAACAGCAAACAGCAAAGGGCAGCAAAGGTCACAGCAAAGGCTCTACGAATCATACTCAAGCTAACGGATGAATGATAGCCAGATCGTTTAATCCGTTCCTATGAGTGGGGACGTGAGTAAGCCACAGCAAAGGAGCAAAGGGACACAACATCCGATAACTCAGCAAAGGCAGCAACAGCAAAGGGGGAGTGGCAATGAGCACCAGCAAAGGAAGCTCAGCAAAGGATTCGATCCAGCAAAGGAAGGACTGCATCAGCAAAGGGAATAGGATAGCACGACAGCAAAGGTGTCAGCAAAGGCTCTCGGGCCGACACATTTCCCCATGAACCGGTTAGTACTCGAAGGCGAAGGAAAACCTCTCCCCCCAGCCCAGCTTCATCCTTTTGACAGTACGTTGGTATTTACACAGGTTTTGGGCTTTCGCGGTCCTAGTAGCCCAAGAGGCCCCCAGCTTCAGCTTCTATTAGCGGCACGCGAACGCACCTCTAGTTCCCCCAGCTTCACCCAGCTCCCAGCTTCTAAGTAACAGACCCAGCTCCCAGCTTCCTCATGGACCACTCATCAGATCCCTACCACTATTGCGACTGAGTCGAGTCGCTCGTTAAGCCCCAGCTTCCGCGGTGTTTCTTATGAACGGGGGGCCCCAGCTTCCTCGCACGACCCCCCAGCTTCCTCAGAAGTCACTCAAAGTAATCATAACTTGCTCCCAGCTTCACCCAGCTTCCAAAGCGATGTAACGCTGGCGGTCCCAGCTTCGTAATATAACCCAGCCCCAGCTTCGCTTCATCCCAAGCCCAGCTTCCGCTGGTCCCAGCTTCCCAGCTTCGCTTCTGTCTTCGCGAGTTTGGTGAGATATGTTCTTACCCCAGCTTCACCCAGCTTCAACGGAAACGCTTTGACCTCTTAGCGCCCCAGCTTCATAAATCTTTGCTGTTGCTATCCTAGCCACCCCAGCTTCGAATGTCACCACATCTCGGAAACCACATCTCGGAGGTCGTGTCTGCCGGAAAACACATCTCGAATGGTATGACATTCACACATCACATCTCGGCAAGCTATTCAAGATTCACTCACTGATCAGTTTGTTAAGAGGACCACATCTCGCCCACATCTCGCATCTCGACCACATCTCGCGAGAGCGCACATCTCGGACCCATTTTAGCCATCACCCCCTGGACCACATCTCGCCACATCACATCTCGGTGGCACAATCAGCAGTACCCTGCCACATCTCCACATCTCGGACACATCTCGTCTCGCAAACACCATAACGCATGGGCACATCTCGGTACGGTTCCTGGGGGAGTTCAAGACCCCAGTCTCACTAGCACATCTCGTCCATGACACATCACATCTCGTGGCAACCGATTTAACTAAAGGATGACCCGCCTGCTTCGCTTTCACATCTCGATCTCGGGCTGATTGCCACATCTCGCTCGGCACATCTCGTCTCGGCACATCTCGACGCGGCGGACCTGTCACATCTCGTATCACGCATCACATCTCGCTTAGCACTCTGTGCGTAATGTGGTATCGTGATGACACTGCACATCTCGGAAAAACTGGACAGCAGGATGTACAACCTTTCGACGACAACCGGCCTTGCGACACCTTTGGCAGACAAAGCTTACAACTGCGAGGCGAAGATGTCACGAGATGGTATTGGTGAGGCCGCAACCTGGCAAGGAATGGTTGTTCATCGTTGCAAGGCGAAAGTTGACTTGAAATATCCCCGCTGTATCTCCCAGAGGTCTGCCCGGAGTAATAGATCACGCCAGAATGCAGTACATCCAGACCGAGCCGAAAGCCGACCAATCCCACTCTAAGATCTTCAAGAACCCGCTGCTCGCGCCTAACCGACAGGTCCTTTCTGCGCGTCAGTTTCATGGACTAATGAATAGCCCTTTCTGCGCTAGTTCACAAATGGGCGTGGGGTAGGTAGTTCACTCCTCACCAGTGTATTGACCGTAACCTCGAGGTTCGCTGAGCCCTCTGTCCGGCAACCGTAGATTATGTCCATTCGATAAGTTGGGTTCTTCTGCTGCAAGTTCTTCTGGCACTCGTTCTTCTGGGCGAAATTCCATTTATGATCGTTCTTCTGTTCTGGGTTCTTCTGTTAACCTTTCACTTCCTTGCCACCAGTTTTGTTCTTCTGATAAGTTCCGTGTTTCCGTAATAATGTCGGTTCTTCTGCCAGCTCCTTACTGTAGAGCGGCTAAGACTGGTTCTTCTGCTTATGTTCCTGGACATGTTCCGTGTTCTTCTGCGTTCTTCTGCTGGCAACAGTTCTTCGTTCTGTTGTTCTTCTGTTCTGACGGCAAGAGAGATGTTCGTTCTGTTCTTCTGGGTGGGGGGTTCTTCTGCGTTCCTTTACTGCTACTCCCGAGTTCTTCTGGCGGTTCTTCTGGGCCCAGTAGGTGGGAACCGGGGAGTCTGTCCGTTACACGCACTGTTCTTCTGAATCATGTTAACTCGCTTTAGTTCTTCTGGGTTCTTCGTTCTTCTGTTAGTTCTTCTGACAGTTCTTCTGGCGTTCTTCTGACACATAAACCGACAAGGACTACTGTTCTAACTAAGATCGGTTCTTCTGGAGGAACTGGGCGTCTCACAATCTGCTAACATCGCCGAGCGCTAGTGGGACACTACGCCTTCTACTGCGCGACCCTCAGTACAATGAGATAACCCCGGTGATGCTAGCGGTTGCTGTAGAACGCGTCGCAGTGGGACACCACACAAGGTCTACTTCTCCGGCGTCCGAGATGTGGATGATCATTCCCTACATCCACAACCTGCATTATCCTTCTCCGTGAGATACCGAAAAAAGTCATATAACTTGTTTTTCACCCATCGCTTCAGAAGGCCTGGCTGGTACGCTACCGTGACCGACCTCCAGTACTATTTGCCGTTAGCGTGACATGTATTGATGGAAGGGCCTTAGCGTTACGCGGGCAATTACGGAGCAGACTTCGCCCGACGCTTACAAGTCTCGCACCCGCATGGCGCGTTGGTGGGCCTTAGACCCGAATAAAATATCAACTAGCTGTTTTCACGCACGTGTTTCAAATACACTCCTAACGACATACTAATGACACAACACAAGAGATACACGCACGTGTTTCCAGGCTACCTGTACACAAGAGCGAGCACGTGTTTGTGTTTCTATGAACACAAGAGGTGCTGAGGTACCACGTGTTTGGCTCACGTGTTTGCACGTGTTTGCCACGTGTTTCATTACACAAGAGTTGCACGTGTTTGTTTTTTCACACGTGTTTACACAAGAGGCGAAACACAAGAGTGGAAGCTCCGATGGTGACACAAACACAAGAGAGAGCACGTGTTTTTCACGTGTTTCGTGTTTGCAATATTACACAACACGTGTTTAAGAGGACTATGTCTATTAGTTTTATGGCAGTAACGTTCACGTGTTTTGTTTGGACACAAGAGACCACACGTGTTTCCACGTGTTTACACCACGTGTTTAACACATCACGTGTTTTCATCACACAAGACACACGTGTTTCAGGTACGCTCGACACAAGAGCATGTACACAAGAGCACCACGTGCACCACGTGCACGTGTTTGACACGTGTTTAAGAGACACACACAAGAGCGGACACAACACGTGTTTACGTAAGAGCACAGGATCATGGCACATGTTGTACAATCAGCATCGAAGCGGTAGGGGGCTTTAATAAGTTCTTCACAGACCGGGCTATATACCGTCCCCTTTATCGTCTAGCAACAGGGTGGGGCAAACACCTGTTGCTCGCTGTGTGCATCTAAGTCCGTTCCTCTAAAACGCTTACTAATGGTGCCCCCTGAGACCTCAGGTATACATCACCCCCTGGACCGTGCATCCGGGGCTCATGAGACGATCGCAAAGGAGTTCGTGTATTGTTTCCGATCATCGTGTAAATTGATTCGCTATGCTTTTAAGCTTTCGTTGGGGGTAGGTTCCATGCAACGTCTGGCGAGGTATCCTCTGTGTTGGAGTCCAGCCGAGGTATCCCTCTGTAGGGAATATTGTCCTCCTCAGAGTCGTAATTGGACGCGTGAGATTATAGACGTAAGTAGGCTGATTGATGTCCAAACCCTATACCTAACCCCGGGCTGCGTTCTTAGGGTGACTGAAAATGTCTCTTGTGAGGTCGGCTCGCTGAAAATTGTACGGGAAAACGGATAGCGTTATCAGGGAAAACCCCCACACCGCACTGGCGAACGTCTATACGTTCCTGGTTAGTTTCGGACGTGGTGGACATCACATGTTCCATCGGGGTTCACAACGTTAGCGGATATAAATGCATGACTTTTGGCTGCGAAGGAGTCCCCGGCTGCCTCGCCCCCAGCCGCCAGGCTATCGGTACCACGCCCAGCGGAGTAGGCAGATCCCAGTTTGAGCAGACTGCTTTCTAAGGGGCATTCAGTGGTAATAATCTTGAAATTACGTCGACGAGACAACTTTGAAATCTCTATACACAATTTCTAAGCAATCGCCCGGCAGATGAGGAGTCCCCGCCGAGCGTGTACTAGAAAGCACTCGCGTCATTCCCTCAGACACCGCGTGAAGCTCAGTGATGTGAAGTAGCATAATGCTGTCTGCGCAGGTAGTAGCTCTAATGGTAACACCTTACCTAATAAGCTTAAGTAAAGAGGGTATACCATTACAGGCAGTCGGTGCTATCATACCCTCAAAAACGCCCCACGGTAAAAGGACCTTCTGCGCAATCTAAAAGTTCTACCTTCCCAGAGTAATAGTTCGTGATGCTCTACGTTCTACATGCCAACATCTACAAATTATGGCCGTGACCCATGTATCGCCTCGTCCAATGTGTTTGCTTCGGATGATCCTAAGTGGCACCCGGGAATAGTCACTAGGTCGTACGTGTTTTAGTGAATTCCTTTTTGGGTTTGAGATTCTCACCAGCAGGTTGTGGGTAACCGCGCCCGGGAAGGCGTTAAGTAACTCGGTATGTTCTTTTAAACGTCTTTTAAAACGTCTTCTTTTAAAGGTCTTCTTTTTCTTTTATTTCGAAGGTTTCGATTTCGAAGGCAGTAGTCTTCTTTTCGATTTCGAAGGTATCTTTTAAAGTATCTGCTCGTGTCCTCTTGCTCGTGTATGCTCGTGTTTCTGCTCGTGTGCTGCTGGTTGCTCGTGTGGGTGCTCGTGTAAGTTGCTCGTGCTCGTGTAGGCTGCGTTGCTCGTGTTTTCGAAGGGAGATAAGAATTTCGAAGGTTAATGCTCGTGTCACTGTTGCTCGTGTTGTGGTTTTCGAAGGTTAAATGTGAGTCGACCTTGCTCGTGTTCGTTGCTCGTGTGATCTTTCGAAGGTCGTGCTCGTGTATAGTCTTTCGAAGGTGACGTGTATTTGGTGCTCGTGTGAAGGTTTTCGAAGGATTTCGAAGGTTTCGAAGGTGATATCTTTTTTCGAAGGTGCTCGTGTCTCGTGTGCTCGTGTCTCGTGTGAACTACATCGTTCTTTTTTTCTGCTCGTGTGGCGATTTCGAAGGATTTCGAAGGTTTAAATTTCGAAGGTCGAAGGTGCTCGTGCTCTGCTCTGCTCGTGTCACATTCGAGGATTCGGGGACAGGATTTGCTCGTGTAAGCCCGGAACCGAGTAGTGCTCGTGTGGGGTCGCGATTATAGTGCTCGTGTAGTGGAACAAATGCTCGTGTTGACCCTCATTCAACCGCATCTCAAGGATGGGTGCACCGAAAGGATTCCCGGAATTGACCCACAACTTAAGACGCCTTTGCGCCTTCTGTGTACGACAGGGAAATCGGTAAGCTTCAAGCCCGGGCAGAGATAGCCTAATTTGACACGGAAGTACGTCAGCTGGATTACGTATAGGGGTCTCACCTAACATGTTAGTCGTAACGCCGTTATAAGGACGCACACTTGAATTCATGATTAGAAGACTCGCCGGGGAGACGTGGAGTTATTTCCAATACTGGTGAGGGCGGCTAGTTTACCAAGAGGCGTTATCGCGGAGCTAGCCTTCGAAGTAGCTCCGATTACCAGTGGCATTTAGGCTCGCATACCCGACTGTTCTCCCAGCGGTGAAGAGGCGAGCAATCTTATGTCAGGACGCGTACCATCGGTTGCGCCGAAATCACACATGCTTATCCAATGGGTCGTGTGCATTGGCTGGTGCTTATCCATAGCTCGCAAGTATGCACTTGATTATATCCTTGGGGGCACGTACTGTGACCGGGGATC"
k = 9
L = 499
t = 17

result = find_clumps(genome, k, L, t)
print(" ".join(result))  
